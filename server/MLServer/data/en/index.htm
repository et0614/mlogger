<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex,nofollow">
    <meta http-equiv="refresh" content="60; URL=">
    <title>Measurement status</title>
    <link rel="stylesheet" href="../style.css">

    <script src="../dataTable.js"></script>
    <script src="../p5.min.js"></script>
    <script src="../draw.js"></script>
    <script src="../sketch.js"></script>
</head>
<body>
    <h2>Measurement status</h2>

    <b>Number of M-Loggers connected: </b><span id="mlNum"></span> unit(s)<br><br>
    <b>List of M-Loggers:</b><br><br>
    <div id="loggers">
        <table align="left" id="mlTable">
            <thead>
                <tr>
                    <th class="general_h" onclick="sortTable(0)">Last connection</th>
                    <th class="general_h" onclick="sortTable(1)">Name</th>
                    <th class="general_h" onclick="sortTable(2)">Address</th>
                    <th class="thlog_h" onclick="sortTable(3)">Date and time</th>
                    <th class="thlog_h" onclick="sortTable(4)">Dry-bulb temperature [C]</th>
                    <th class="thlog_h" onclick="sortTable(5)">Relative humidity [%]</th>
                    <th class="glblog_h" onclick="sortTable(6)">Date and time</th>
                    <th class="glblog_h" onclick="sortTable(7)">Globe temperature [C]</th>
                    <th class="vellog_h" onclick="sortTable(8)">Date and time</th>
                    <th class="vellog_h" onclick="sortTable(9)">Velocity [cm/s]</th>
                    <th class="illlog_h" onclick="sortTable(10)">Date and time</th>
                    <th class="illlog_h" onclick="sortTable(11)">Illuminance [lx]</th>
                    <th class="cmftlog_h" onclick="sortTable(12)">MRT</th>
                    <th class="cmftlog_h" onclick="sortTable(13)">SET</th>
                    <th class="cmftlog_h" onclick="sortTable(14)">PMV</th>
                    <th class="cmftlog_h" onclick="sortTable(15)">PPD[%]</th>
                    <th class="general_h">DL</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <br clear="all">
    <span id="clomet"></span>
    <hr>
    <br/><br/>

    <button id="toggleName" onclick="toggleDisplay()">Hide heat map</button>

    <div id="heatMapBlock" style="display: block;">  
        <h2>Heat map</h2>
        <form>
            <group class="inline-radio">
                <div>
                    <input type="radio" name="mode" value="dbt" onchange="handleModeChange()" checked>
                    <label>Drybulb temperature</label>
                </div>
                <div>
                    <input type="radio" name="mode" value="hmd" onchange="handleModeChange()">
                    <label>Relative humidity</label>
                </div>
                <div>
                    <input type="radio" name="mode" value="glb" onchange="handleModeChange()">
                    <label>Globe temperature</label>
                </div>
                <div>
                    <input type="radio" name="mode" value="vel" onchange="handleModeChange()">
                    <label>Velocity</label>
                </div>
            </group>
            <group class="inline-radio">
                <div>
                    <input type="radio" name="mode" value="ill" onchange="handleModeChange()">
                    <label>illuminance</label>
                </div>
                <div>
                    <input type="radio" name="mode" value="pmv" onchange="handleModeChange()">
                    <label>PMV</label>
                </div>
                <div>
                    <input type="radio" name="mode" value="ppd" onchange="handleModeChange()">
                    <label>PPD</label>
                </div>
                <div>
                    <input type="radio" name="mode" value="clear" onchange="handleModeChange()">
                    <label>Clear</label>
                </div>
            </group>
        </form>
    
        <div id="canvas-container"></div>
    </div>

    <hr>
    Web site: <a href="https://www.mlogger.jp">https://www.mlogger.jp</a>

    <script>
        //一般情報をロード
        loadMLoggerInfo('../latest.json');

        //計測情報をロード
        loadMLoggerTable('../latest.json');

        function handleModeChange() {
            // ラジオボタンが変更された時に呼び出される関数
            var selectedMode = document.querySelector('input[name="mode"]:checked').value;
            switch (selectedMode) {
                case "dbt":
                    changeMode(MODE.DBT);
                    break;
                case "hmd":
                    changeMode(MODE.HMD);
                    break;
                case "glb":
                    changeMode(MODE.GLB);
                    break;
                case "vel":
                    changeMode(MODE.VEL);
                    break;
                case "ill":
                    changeMode(MODE.ILL);
                    break;
                case "pmv":
                    changeMode(MODE.PMV);
                    break;
                case "ppd":
                    changeMode(MODE.PPD);
                    break;
                case "clear":
                    changeMode(MODE.CLEAR);
                    break;
                default:
                    break;
            }
        }
        
        function toggleDisplay() {
            var element = document.getElementById("heatMapBlock");
            var elem2 = document.getElementById("toggleName");
            if (element.style.display === "none") {
                element.style.display = "block";
                elem2.textContent = "Hide heat map";
            } else {
                element.style.display = "none";
                elem2.textContent = "Display heat map";
            }
        }
    </script>

</body>
</html>